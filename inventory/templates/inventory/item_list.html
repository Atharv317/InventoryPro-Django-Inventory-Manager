<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Inventory</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1>Inventory</h1>
    <div>
      <span class="me-3">Welcome, <strong>{{ user.username }}</strong></span>
      <a href="{% url 'logout' %}" class="btn btn-outline-secondary btn-sm">Logout</a>
    </div>
  </div>

  <form method="get" class="row g-2 mb-3">
    <div class="col-auto">
      <input type="text" name="q" value="{{ q }}" class="form-control" placeholder="Search name...">
    </div>
    <div class="col-auto">
      <input type="text" name="category" value="{{ category }}" class="form-control" placeholder="Category...">
    </div>
    <div class="col-auto">
      <button class="btn btn-primary">Search</button>
      <a href="{% url 'item_list' %}" class="btn btn-outline-secondary">Clear</a>
    </div>
    <div class="col text-end">
      {% if low_stock_count %}
        <span class="badge bg-danger">Low stock: {{ low_stock_count }}</span>
      {% endif %}
      <a href="{% url 'add_item' %}" class="btn btn-success ms-2">+ Add Item</a>
    </div>
  </form>

  <div class="card">
    <div class="table-responsive">
      <table class="table table-hover mb-0">
        <thead class="table-light">
          <tr>
            <th>Name</th>
            <th>Qty</th>
            <th>Price</th>
            <th>Category</th>
            <th>Threshold</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for item in items %}
          <tr class="{% if item.is_low_stock %}table-warning{% endif %}">
            <td>{{ item.name }}</td>
            <td>
              {{ item.quantity }}
              {% if item.is_low_stock %}
                <span class="badge bg-danger ms-2">Low</span>
              {% endif %}
            </td>
            <td>{{ item.price }}</td>
            <td>{{ item.category }}</td>
            <td>{{ item.low_stock_threshold }}</td>
            <td>
              <a href="{% url 'edit_item' item.pk %}" class="btn btn-sm btn-outline-primary">Edit</a>
              <a href="{% url 'delete_item' item.pk %}" class="btn btn-sm btn-outline-danger">Delete</a>
            </td>
          </tr>
          {% empty %}
          <tr><td colspan="6" class="text-center text-muted">No items found.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

</div>
</body>
</html>
